\section{Numerical Experiments}\label{sec:exp}

\textbf{Universal Rates:} Let $d=2$, for any $P\in \P_{UNS}$, $A_P=\left[\begin{matrix}1 &0\\ 0 & a_P\end{matrix}\right]$, for some $a_P\in (0,1)$, let $b_P=\left[\begin{matrix}0\\0\end{matrix}\right]$, $A_t=A_P,\forall t\geq 0$and $N_t=\left[\begin{matrix}\zeta(1)_t\\ \zeta(2)_t\end{matrix}\right]$, where $\zeta(i)_t, i=1,2$ are \iid uniform random variables taking values in $[-1,1]$. $\P_{SN}$ is the same as $\P_{UNS}$ except that, in $\P_{SN}$ the noise $N_t=A_P \left[\begin{matrix}\zeta(1)_t\\ \zeta(2)_t\end{matrix}\right]$, i.e., the noise scales with $A_P$. Note that $\P_{SN}\subset \P_{SPDSN}$ and $\P_{USN}\subset \P_{SPD}$, and the subscripts $SC$ and $USN$ stand for \emph{scaled} and \emph{unscaled} noise respectively. 
The \Cref{fig:results} (left most plot) shows $EE=\EE{\normsm{\thh_t-\ts}^2}$ (estimation error) and $PE_{USN}=\EE{\normsm{\thh_t-\ts}^2_{A_P}}$ (prediction error without scaled noise) measured for the class $\P_{USN}$,  and $PE_{SN}=\EE{\normsm{\thh_t-\ts}^2_{A_P}}$ ( prediction error with scaled noise)  measured for the class $\P_{SN}$. Thus $EE, PE_{USN}$ and $PE_{SC}$ respectively illustrate cases $(i)$, $(ii)$ and $(iii)$ of \Cref{th:pspd}. To obtain $EE$, we let $\alpha=0.9$, $a_P=\frac{1}{t}$. We observe that $EE$ increases $O(t)$. To obtain $PE_{USN}$, the adversarial choice $a_P=\frac{1}{\sqrt{t}}$ was chosen for a given $t$ and $\alpha=\frac{1}{\sqrt{t}}$ was chosen. We observe that $PE_{USN}$ decreases only at $O(\frac{1}{\sqrt{t}})$ as remarked in \Cref{sec:land}. To obtain $PE_{SN}$, we chose $\alpha=0.9$ and $a_P=\frac{1}{t}$, and it obeys the $O(\frac{1}{t})$ rate.

\textbf{Mountain Car (setup):}  The mountain car is a widely used domain for policy improvement tasks, however, here, we use the domain for approximate policy evaluation. The domain consists of an under powered car, that needs to swing from the bottom of the valley to the top by performing either one of the three possible actions: \emph{forward, reverse, no} throttle. Since the car is under-powered, it cannot directly accelerate to the top from the bottom and needs to swing back and forth to reach the top. The state of the system is described the position $p$ and the velocity $v$ of the car at a given time. For the purpose of \emph{on-policy} evaluation, we sample from the policy $\pi$ that accelerates in the direction of the velocity with probability $\frac{298}{300}$ and the other two actions with probability $\frac{2}{300}$. Since, we are also interested in the \emph{off-policy} case, we sampled using a behavior policy  $\pi_b$ that accelerates in the direction of the velocity with probability $\frac{8}{10}$ and chooses the other two actions with probability $\frac{2}{10}$. We used \emph{tile coding} and \emph{Fourier} basis (un-normalized and normalized). We used $4$ different tiling ($4\times 4$ and $7\times 7$ gird for the two state variables permuted with $5$ and $10$ tiles), and we also tried $4$ different $n^{th}$ Fourier basis function ($n=3,5,7,9$), with $d=(n+1)^2$. For a given state $s=(p,v)$\footnote{We scale the states by subtracting the minimum value and dividing it by its range, so that $p,v\in(0,1)$ after scaling}, the Fourier feature is given by $\phi(p,v)=\big(cos(\pi [c_1p+c_2 v],c_1,c_2=0,1,\ldots,n)\big) \in \R^{d}$ (where $d=(n+1)^2$). The normalized features were obtained by letting $\normsm{\phi(s)}^2_2=1$. We generated $100$ trajectories for the \emph{on/off}-policies, and the discount factor we used was $\gamma=0.999$. 

Before discussing the observations, we digress, to mention two important aspects related to LSA algorithms, which, while being out of the scope of this paper, nevertheless are important in practice.

\textbf{Singularity:} In \Cref{assmp:lsa} we assumed that the matrix $A_P$ is Hurwitz and hence invertible. When the underlying matrix is singular, there could be two scenarios, first,  $A_P\theta=b_P$ has infinitely many solutions, second, $A_P\theta=b_P$ has no solution. In the former scenario, and under a further assumption that the null-space is diagonalizable (see \cite{bertstab}), the null space can be discarded after applying an appropriate linear transformation $U$ (as in \Cref{th:rate}) to a obtain a reduced linear system $\tilde{A}_P\tilde{\theta}=\tilde{b}_P$. This reduced linear system has a unique solution and then the results of \Cref{th:rate} can be applied.

\textbf{Design of Updates:} Note that the CATD(0) and CAGTD have different underlying linear systems. This is evident by writing down $(b_P,A_P)$ for TD(0) and GTD respectively. Let $A_t=\phi_t(\phi_t-\gamma\phi'_t)^\top$, $b_t=r_t \phi_t$ , then for CATD(0), $A_{TD}=\EE{A_t}$ and $b_{TD}=\EE{b_t}$.  For CAGTD we have $A_{GTD}=\left[\begin{matrix}I & A_{TD} \\ -(1-\alpha )A_{TD}^\top &\alpha A_{TD}^\top A_{TD}\end{matrix}\right]$ and $b_{GTD}=[b_{TD}^\top,\alpha b_{TD}^\top A_{TD}]^\top$. The eigenvalues in the case of  CAGTD, involves $A_{TD}^\top A_{TD}$, i.e., a small eigenvalue of $A_{TD}$ gets squared, consequently CAGTD is poorly conditioned in comparison to CATD(0).
\input{fig}
\begin{itemize}[leftmargin=*]
\item \textbf{Stability:} For CATD(0), we ran  \emph{on-policy} with all the three features and \emph{off-policy} with normalized features. For CAGTD, we ran with all the features and both \emph{on/off-policy}. In all the experiments, we chose step-size dictated by \Cref{th:tdadmis}, and all the experiments were stable (bottom two rows of \Cref{fig:results}).The values are averaged over $10$ runs and since the variance was not significant, the error bars are not given.
\item \textbf{Near Singularity: } We observed in the case of tile coding and normalized Fourier basis functions the underling $A_{TD}$ matrices were nearly singular, i.e., small eigenvalues with positive real-parts close $0$. However, we observed that the error $\EE{\normsm{A_{TD}\thh_t -b_{TD}}^2}$ converges to $0$ (left plot in the second row of \Cref{fig:results}). We also observed that $\EE{\normsm{A_{GTD}\hat{z}_t-b_{GTD}}^2}$ converges to $0$ (right plot in the second row of \Cref{fig:results}), where $\hat{z}_t=[\hat{y}_t^\top,\thh_t^\top]^\top$. Here, $\thh_t$ is the primal variable and $\hat{y}_t$ is the dual variable. However, $\EE{\normsm{A_{TD}\thh_t-b_{TD}}^2}$ does not always converge to $0$ (tile coding in right plot in the third row of \Cref{fig:results}). This might be due to the fact that linear systems underlying CATD(0) and CAGTD are different. 
\item \textbf{Slowness of GTD:} Unnormalized Fourier basis were better conditioned in comparison to the other basis choices. In this case, for CATD(0) and CAGTD $\EE{\normsm{A_{TD}\thh_t -b_{TD}}^2}$ converges to $0$. However, the CAGTD is slower in comparison to CATD(0) (left plot in the third row of \Cref{fig:results}), due to the fact that $A^\top_{TD}A_{TD}$ matrix is involved in the spectrum of CAGTD, leading to the squaring of small eigenvalues.
\end{itemize}

\textbf{BAIRD:} In this domain there are $S=\{s_1,\ldots,s_7\}$ states and $A=\{a_1,a_2\}$ actions. Under, $a_1$ we have $p_{a_1}(s,s_1)=1, \forall s\in S$ and under $a_2$ we have $p_{a_2}(s,s')=\frac{1}{6}, \forall s\in S, s'=2,\ldots,7$. The samples are collected using a behaviour policy $\pi_b$ that performs action $a_2$ with probability $\frac{6}{7}$ and action $a_1$ with probability $\frac17$, and the target policy that we are interested is $\pi$ which performs action $a_1$ in all the states. The feature vector we chose was: $\phi(s_1)=[\frac{1}{2}\,0\,0\,0\,0\,0\,0\,1]$, $\phi(s_i)=e_i+[0\,0\,0\,0\,0\,0\,0\,\frac{1}{2}], i=2,\ldots,7$, where $e_i$ is the standard basis with $i^{th}$ co-ordinate $1$ and rest of the co-ordinates $0$. Since $\phi'_t$ always corresponds to state $1$ and is different from $\phi_t$, in this example $\E[{\phi_t\phi_t}]\neq\E[{\phi'_t{\phi'_t}^\top}]$.
We compared the performance of GTD with $\alpha=0.005$ (and $\beta=16$, see \cite{gtdmp}) with the choice of $\alpha=\frac{1}{2\times 2}$ ($2$ is to normalize the features) and initial condition $\theta_0=[1\, 1\, 1\, 1\, 1\, 1\, 10\, 1]$. The identical step-size of $\frac{1}{4}$ performed better than choosing different step-sizes for the primal and dual variables. Please refer to the top right plot of \Cref{fig:results}.

